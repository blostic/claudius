<!DOCTYPE html><html lang="en"><head><title>examples/specify_instances</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="examples/specify_instances"><meta name="groc-project-path" content="examples/specify_instances.rb"><meta name="groc-github-url" content="https://github.com/blostic/cloud-experiment"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/blostic/cloud-experiment/blob/master/examples/specify_instances.rb">examples/specify_instances.rb</a></div></div><div id="document"><div class="segment"></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="specify-instances">Specify instances</h2>

<p>To conduct an experiment remotely, You should define set of machines, which you would like to use. Claudius allows you to define 2 types of hosts - ones which are going to be created in clouds environment, and others which are already established (and you have access to them). To define machine and to maintain connection with them you should provide required parameters. For your convenience, you may store all yours parameters in json file, and recall them as it is presented in example.</p></div></div><div class="code"><div class="wrapper"><span class="nb">require</span> <span class="s1">&#39;claudius&#39;</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;./user_config.json&#39;</span><span class="p">)</span>
<span class="n">experiment</span> <span class="s1">&#39;Hello&#39;</span> <span class="k">do</span>
  <span class="n">define_providers</span> <span class="k">do</span>
    <span class="n">cloud</span><span class="p">(</span><span class="s1">&#39;aws&#39;</span><span class="p">,</span>  <span class="ss">:provider</span> <span class="o">=&gt;</span> <span class="n">config</span><span class="o">[</span><span class="s1">&#39;provider&#39;</span><span class="o">]</span><span class="p">,</span>
          <span class="ss">:region</span> <span class="o">=&gt;</span><span class="n">config</span><span class="o">[</span><span class="s1">&#39;region&#39;</span><span class="o">]</span><span class="p">,</span>
          <span class="ss">:endpoint</span> <span class="o">=&gt;</span> <span class="s1">&#39;https://ec2.eu-west-1.amazonaws.com/&#39;</span><span class="p">,</span>
          <span class="ss">:aws_access_key_id</span> <span class="o">=&gt;</span> <span class="n">config</span><span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span><span class="p">,</span>
          <span class="ss">:aws_secret_access_key</span> <span class="o">=&gt;</span> <span class="n">config</span><span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span><span class="p">)</span>
    <span class="o">.</span><span class="n">create_instances</span><span class="p">(</span><span class="o">[</span><span class="s1">&#39;t1.micro=&gt;in1&#39;</span><span class="o">]</span><span class="p">,</span>
                      <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="s1">&#39;ubuntu&#39;</span><span class="p">,</span>
                      <span class="ss">:private_key_path</span> <span class="o">=&gt;</span><span class="s1">&#39;./Piotr-key-pair-irleand.pem&#39;</span><span class="p">,</span>
                      <span class="ss">:key_name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Piotr-key-pair-irleand&#39;</span><span class="p">,</span>
                      <span class="ss">:groups</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;Piotr-irleand&#39;</span><span class="o">]</span><span class="p">)</span>
    <span class="n">manual</span><span class="p">(</span><span class="s1">&#39;kali&#39;</span><span class="p">,</span> <span class="s1">&#39;172.16.0.109&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="ss">:password</span> <span class="o">=&gt;</span> <span class="s1">&#39;toor&#39;</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="n">foreach</span> <span class="o">[</span><span class="s1">&#39;kali&#39;</span><span class="p">,</span> <span class="s1">&#39;in1&#39;</span><span class="o">]</span> <span class="k">do</span> <span class="o">|</span><span class="n">instance</span><span class="o">|</span>
    <span class="n">on</span> <span class="n">instance</span> <span class="k">do</span>
      <span class="n">execute</span> <span class="k">do</span>
        <span class="n">ssh</span> <span class="s2">&quot;echo Hello World! &gt; TestFile&quot;</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></div></div></div></div></body></html>